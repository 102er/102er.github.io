---
layout: post
title: '消息队列组件'
date: 2019-07-11
author: blossom
cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-banner.png'
tags: kafka rabbitMq 消息队列
---

> 消息队列，比较kafka和rabbitMQ的差异，实践rabbitMQ

### 基础
消息队列中间件是通过高效可靠的消息传递机制进行与平台无关的数据交流，并基于数据通信来进行分布式系统集成。通过提供消息传递和消息排队模型，可以在分布式环境
下实现应用解耦，异步通信，数据同步,限流/削峰等功能。
#### 什么是消息队列
消息队列（message queue）消息即数据信息，队列即一种先进先出的数据结构，组合一起：把需要传输的数据放进队列中。<br>
生产者：把数据消息放进队列；<br>
消费者：把数据消息从队列中读取出来；
#### 特点
* 异步处理模式，消息发送者无须等待响应，只要按照特定主题把消息推送到队列，而消息接收者只需订阅或者监听某个主题消息通道，。整个过程都是异步的。
* 解耦，不同组件通过消息中间件，进行业务解耦，这样可以避免某个流程崩溃导致整个业务崩溃。
* 限流，数据请求放消息队列，由消费者主动去读取消息，pull的当时可以避免业务处理系统压力过大。
#### 模式
* 点对点的模式，生产者把消息投递到queue中，消费者从queue中读取消息，成功接收消息后像队列应答，此时队列将会删除这条消息，所以一个消息只能被读取一次；
* 发布/订阅模式，生产者把消息投递到topic，系统将会把这些消息传递给订阅方；

### Kafka

### rabbitMQ
基于amqp（Advanced Message Queuing Protocol）实现的高级消息队列协议。
#### 特性
* 可靠性，支持消息持久，投递确认，发布者证实，高可用等机制；
* 灵活路由，提供exchange来路由消息，可以支持绑定多个exchange；
* 消息集群 多个rabbitmq可以组成一个逻辑的 broker
* 高可用 队列可以在集群中的机器进行镜像，部分节点出问题，不会影响整个队列使用
* 多语言客户端 几乎支持所有常用语言客户端
* 提供管理界面，可以管理和监控消息队列
* 跟踪机制 提供消息追踪机制，使用者可以追溯消息的生命周期
#### 名词解释
    - Message 消息，由消息头和消息体组成，消息头由：routing-key（路由键）、priority（相对于其他消息的优先权）、delivery-mode（指出该消息可能需要持久性存储）等组成；
    - Publisher 消息生产者 、
    - Exchange 交换机，接收生产者投递的消息并把消息路由给队列
    - Routing key 路由关键字 exchange根据关键字进行消息投递
    - Binding 绑定，用于消息队列和交换机之间的关联。一个绑定是基于路由键将交换机和消息队列连接起来的路由规则，所以可以将交换机理解成一个由绑定构成的路由表
    - Queue 消息队列 用来保存消息，直到消息被消费，消息容器
    - Channel 信道
    - Consumer 消费者 ，从消息队列读取消息
    - Virtual host 虚拟主机 表示一批交换器、消息队列和相关对象。每个虚拟机主机都是独立的
    - broker 接收和分发消息的应用，消息队列服务器的实体
