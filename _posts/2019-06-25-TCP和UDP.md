---
layout: post
title: 'TCP和UDP'
date: 2019-06-25
author: blossom
cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-banner.png'
tags: 网络协议 TCP UDP
---

> 了解tcp和udp，对别两种连接的差异 基础知识 目前只做连接，没有深入

### 基础
#### 1.1 TCP
TCP（Transmission Control Protocol）是传输控制协议，可以提供面向连接、可靠，点到点的通信，是基于字节流的传输层通信协议；
tcp的特点：可靠传输，顺序控制，重发控制 还能实现流量控制，拥塞控制等；
tcp在发送数据前，必须经过3次握手，才能建立连接，握手过程如下：
![tcp连接](https://blossom102er.github.io/assets/img/tcp.png)
* 客户端发出SYN连接请求， Sequence设置为一个随机数A。
* 服务端回应SYN-ACK，ACK内容设置为A+1，Sequence设置为一个随机数B。
* 客户端回应ACK，ACK内容设置为B+1，Sequence设置为A+1。
我们用tcpdump抓一下数据包，如下：
![tcp连接抓包](https://blossom102er.github.io/assets/img/tcp-conn.png)

关闭tcp连接，需要4次握手，过程和建立连接差不多，多了一个server到客户端的ack，我们测试关闭连接的过程：
![tcp关闭连接](https://blossom102er.github.io/assets/img/tcp-close.png)

#### 1.2 UDP
UDP（User Datagram Protocol）是不可靠的数据报协议，它不能确定消息一定会送到接收端，即使网络出现丢包，也不会负责重发数据，所以在应用端可以根据自己的需要重发数据；
udp的特点：不可靠，无序
### tcp和udp对比
* tcp基于连接，udp无连接
* tcp占用资源多，udp占用资源开销少
* 通信模式不一样，tcp是流模式，udp是数据报模式
* tcp保证数据的正确性，udp可能会丢包
* tcp保证数据顺序，udp不保证

